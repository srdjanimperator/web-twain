<!DOCTYPE html>
<html>
  <head> </head>
  <body>
      <input type="text" id="txt" value="twain_img">
      
      <button onclick="doSend(document.getElementById('txt').value)" type="button">Test</button>
      <br />
      <img id="scannedImage" style="width: 50vw;" />
    <script>
      var wsUri = "ws://127.0.0.1:8083";
      var ws = new WebSocket(wsUri);

      console.log(ws);
      ws.onopen = function (e) {
        console.log("CONNECTED");
        doSend("TEST MSG")
      };
      ws.onclose = function (e) {
        console.log("DISCONNECTED");
      };

      ws.onmessage = function (e) {
        let str = e.data + '';
        console.log(str);
        if (str.includes("data:image")) {
          console.log("img received")
          document.getElementById("scannedImage").src = str;          
        }
      };

      ws.onerror = function (e) {
        console.log("ERROR: " + e.data);
      };

      function doSend(message) {
        console.log("SENT: " + message);
        ws.send(message);
      }
    </script>
  </body>
</html>
